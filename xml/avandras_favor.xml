<?xml version="1.0" encoding="iso-8859-1"?>

<root>
    <windowclass name="AvandrasFavor">
        <frame>campaignlistwithtabs</frame>
        <sizelimits>
            <minimum width="600" height="500" />

        </sizelimits>
        <minimize>minimized_reference</minimize>
        <playercontrol />
        <!-- Debug message -->
        <!-- <script>
      function onInit()
        gamescript.game_init(self)
      end
        </script> -->
        <sheetdata>
            <windowtitlebar name="title">
                <resource>avandras_favor_title</resource>
            </windowtitlebar>
            <close_campaignlist />
            <resize_campaignlistwithtabs />

            <basicstring name="intro">
                <anchored position="insidetopleft" offset="50,100" width="500"/>
                <static>
                Players roll 2d6. If they add to a 7 or 12, the player wins. Gamblers can double the bet to add 1d6 to the total.
                </static>
            </basicstring>

            <!-- First Roll -->
            <numbercontrol name="first_roll">
                <anchored position="insidetopleft" width="80" height="60" offset="100,200" />
                <frame name="abilityscore" />
                <nodrag />
                <nodrop />
                <font>modcollector</font>
                <nokeyedit />
            </numbercontrol>
            <buttoncontrol name="button_first_roll">
                <anchored height="40" to="first_roll" position="below" offset="0,0" />
                <icon normal="d6gicon" pressed="d6gicon"/>
                <tooltip textres="first_roll_1d8" />
                <script>
                    function onButtonPress()
                        window.first_roll.setValue(gamescript.roll_1d6());
                        local sText = "is rolling their FIRST ROLL"
                        gamescript.send_message(sText)
                        local curTotal=window.first_roll.getValue() + window.second_roll.getValue() + window.extra_roll.getValue()
                        window.current_total.setValue(curTotal) if(curTotal==7 or curTotal==12) then
                            window.current_total.setColor("#008000");
                        else
                            window.current_total.setColor("#FF0000");
                        end
                    end;
                </script>
            </buttoncontrol>
            <basicstring name="first_roll_label">
                <anchored to="first_roll" position="above" offset="0,0" />
                <static>
                    <textres>first_roll_1d8</textres>
                </static>
                <nodrag />
                <nodrop />
            </basicstring>
            <!-- Second Roll -->
            <numbercontrol name="second_roll">
                <anchored position="insidetopleft" width="80" height="60" offset="250,200" />
                <frame name="abilityscore" />
                <nodrag />
                <nodrop />
                <font>modcollector</font>
                <nokeyedit />
            </numbercontrol>
            <buttoncontrol name="button_second_roll">
                <anchored height="40" to="second_roll" position="below" offset="0,0" />
                <icon normal="d6gicon" pressed="d6gicon"/>
                <tooltip textres="second_roll_1d6" />
                <script>
                    function onButtonPress()
                        window.second_roll.setValue(gamescript.roll_1d6());
                        local sText = "is rolling their SECOND ROLL"
                        gamescript.send_message(sText)
                        local curTotal=window.first_roll.getValue() + window.second_roll.getValue() + window.extra_roll.getValue()
                        window.current_total.setValue(curTotal) if(curTotal==7 or curTotal==12) then
                            window.current_total.setColor("#008000");
                        else
                            window.current_total.setColor("#FF0000");
                        end
                    end;
                </script>
            </buttoncontrol>
            <basicstring name="second_roll_label">
                <anchored to="second_roll" position="above" offset="0,0" />
                <static>
                    <textres>second_roll_1d6</textres>
                </static>
                <nodrag />
                <nodrop />
            </basicstring>
            <!-- Extra Roll -->
            <numbercontrol name="extra_roll">
                <anchored position="insidetopleft" width="80" height="60" offset="400,200" />
                <frame name="abilityscore" />
                <nodrag />
                <nodrop />
                <font>modcollector</font>
                <nokeyedit />
            </numbercontrol>
            <buttoncontrol name="button_extra_roll">
                <anchored height="40" to="extra_roll" position="below" offset="0,0" />
                <icon normal="d6gicon" pressed="d6gicon"/>
                <tooltip textres="extra_roll" />
                <script>
                    function onButtonPress()
                        window.extra_roll.setValue(gamescript.roll_1d6());
                        local sText = "is rolling their EXTRA ROLL"
                        gamescript.send_message(sText)
                        local curTotal=window.first_roll.getValue() + window.second_roll.getValue() + window.extra_roll.getValue()
                        window.current_total.setValue(curTotal) if(curTotal==7 or curTotal==12) then
                            window.current_total.setColor("#008000");
                        else
                            window.current_total.setColor("#FF0000");
                        end
                    end;
                </script>
            </buttoncontrol>
            <basicstring name="extra_roll_label">
                <anchored to="extra_roll" position="above" offset="0,0" />
                <static>
                    <textres>extra_roll</textres>
                </static>
                <nodrag />
                <nodrop />
            </basicstring>
            <!-- Current Total-->
            <numbercontrol name="current_total">
                <anchored position="insidetopleft" width="80" height="60" offset="250,325" />
                <frame name="abilityscore" />
                <nodrag />
                <nodrop />
                <font>modcollector</font>
                <nokeyedit />
                <color>#FF0000</color>
            </numbercontrol>
            <basicstring name="current_total_label">
                <anchored to="current_total" position="above" offset="0,0" />
                <static>
                    <textres>current_total</textres>
                </static>
                <nodrag />
                <nodrop />
            </basicstring>
            <!-- Show Hand -->
            <buttoncontrol name="button_show_hand">
                <anchored height="40" position="insidebottom" offset="0,40" />
                <icon normal="button_showhand" pressed="button_showhand"/>
                <tooltip textres="show_hand" />
                <script>
                    function onButtonPress()
                        local finalvalue = window.first_roll.getValue() + window.second_roll.getValue() + window.extra_roll.getValue()
                        local sText = "Final Hand: " .. window.first_roll.getValue() .. "+" .. window.second_roll.getValue() .. "+" .. window.extra_roll.getValue() .. " = " .. finalvalue;                        
                        gamescript.send_message(sText)
                        if( finalvalue == 7 or finalvalue == 12) then
                            gamescript.send_message("Winner!")
                        else
                            gamescript.send_message("Loser, better luck next time!")
                        end
                    end;
                </script>
            </buttoncontrol>
        </sheetdata>
    </windowclass>
</root>
